{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Slab&display=swap" rel="stylesheet">
    <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css'>
    <link rel="stylesheet" href="{% static 'css/mainApp/home.css' %}" />
    <link rel="stylesheet" href="{% static 'css/mainApp/utils.css' %}" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>

    <style>
        /* The Modal (background) */
        .modal {
            display: none;
            /* Hidden by default */
            position: fixed;
            /* Stay in place */
            z-index: 1;
            /* Sit on top */
            padding-top: 100px;
            /* Location of the box */
            left: 0;
            top: 0;
            width: 100%;
            /* Full width */
            height: 100%;
            /* Full height */
            overflow: auto;
            /* Enable scroll if needed */
            background-color: rgb(0, 0, 0);
            /* Fallback color */
            background-color: rgba(0, 0, 0, 0.4);
            /* Black w/ opacity */
        }

        /* The Alert Modal (background) */
        .alert-modal {
            display: block;
            /* Hidden by default */
            position: fixed;
            /* Stay in place */
            z-index: 1;
            /* Sit on top */
            padding-top: 100px;
            /* Location of the box */
            left: 0;
            top: 0;
            width: 100%;
            /* Full width */
            height: 100%;
            /* Full height */
            overflow: auto;
            /* Enable scroll if needed */
            background-color: rgb(0, 0, 0);
            /* Fallback color */
            background-color: rgba(0, 0, 0, 0.4);
            /* Black w/ opacity */
        }

        /* Modal Content for alertModal*/
        #alertModal .modal-content {
            background-color: green;
            color: white;
            margin: auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
            font-size: 20px;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
        }

        /* Modal Content for alertModal*/
        #spinModal .modal-content {
            background-color: grey;
            margin: auto;
            padding: 20px;
            border: 1px solid #888;
            width: 30%;
            font-size: 20px;
            font-weight: bold;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        /* Modal Content for newForm*/
        #newFormModal .modal-content {
            background-color: #fefefe;
            margin: auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
        }

        /* Modal Content for email utility*/
        #emailModal .modal-content {
            background-color: #fefefe;
            margin: auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
        }

        /* Modal Content for offerletter utility*/
        #offerletterModal .modal-content {
            background-color: #fefefe;
            margin: auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
        }

        /* Modal Content for certificate utility*/
        #certificateModal .modal-content {
            background-color: #fefefe;
            margin: auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
        }

        /* The Close Button */
        .close {
            color: #aaaaaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }

        #alertModal .close {
            color: white;
            font-size: 28px;
            font-weight: bold;
        }

        .close:hover,
        .close:focus {
            color: #000;
            text-decoration: none;
            cursor: pointer;
        }

        .modal .myBtn {
            padding: 10px;
            background-color: blue;
            color: white;
        }
    </style>

    <title>tms: home</title>
</head>

<body>
    <!--! Curved Header Section------------------------------------- -->
    <div class="curved-div">
        <div class="container">
            <h1 id="greet">Hello, <span style="text-transform: capitalize;">{{request.user}}</span></h1>
            <h1 id="welcome">Welcome To TMS</h1>
            <a href="{% url 'logout' %}" class="a-btn-white">
                <div id="logout"><i class='fa fa-sign-out'></i></div>
            </a>
        </div>

        <div class="newFormButton" onclick="newFormModal.style.display='block'">
            New Form
        </div>

        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 319">
            <path fill="#fafafa" fill-opacity="1"
                d="M0,128L48,128C96,128,192,128,288,160C384,192,480,256,576,245.3C672,235,768,149,864,149.3C960,149,1056,235,1152,250.7C1248,267,1344,213,1392,186.7L1440,160L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z">
            </path>
        </svg>
    </div>
    <!--!------------------------------------------------------------  -->

    <!--! MODAL SECTION---------------------------------------------- -->
    {% if messages %} {% for message in messages %}
    <!-- The Modal for Alert Modal -->
    <div id="alertModal" class="alert-modal">
        <!-- Modal content -->
        <div class="modal-content">
            {{message}}
            <span class="close" onclick="alertModal.style.display = 'none'">&times;</span>
        </div>
    </div>
    {% endfor %} {% endif %}

    <!-- Modal for loading spinner -->
    <div id="spinModal" class="modal">
        <!-- Modal content -->
        <div class="modal-content">
            <div class="loader"></div>
            <br />
            <b>Sending Email, Please Wait...</b>
        </div>
    </div>

    <!-- The Modal for New Form -->
    <div id="newFormModal" class="modal">
        <!-- Modal content -->
        <div class="modal-content">
            <span class="close" onclick="newFormModal.style.display = 'none'">&times;</span>
            <form method="POST" action="">
                {% csrf_token %}
                <input type="hidden" name="newForm" value="True" />
                <label for="name">Description: </label> <br />
                <textarea name="description" id="description" cols="40" rows="5"></textarea>
                <br />
                <br />

                <label for="domains">Domains: </label> <br />
                <textarea name="domains" id="domains" cols="40" rows="5"></textarea>
                <br />
                <br />

                <input type="submit" value="Create" class="myBtn" />
            </form>
        </div>
    </div>

    <!-- The Modal for email utility -->
    <div id="emailModal" class="modal">
        <!-- Modal content -->
        <div class="modal-content">
            <span class="close" onclick="emailModal.style.display = 'none'">&times;</span>
            <form method="POST" action="sendEmail/" enctype="multipart/form-data">
                {% csrf_token %}
                <input type="hidden" name="email_utility" value="True" />
                <label for="email_heading">Email Heading: </label>
                <input type="text" name="email_heading" id="email_heading" />
                <br />
                <br />
                <label for="email_body">Email Body: </label> <br />
                <textarea name="email_body" id="email_body" cols="30" rows="10"></textarea>
                <br />
                <br />
                <hr />
                <label for="receipnt">To: </label>
                <input type="text" name="receipnt" id="receipnt" />
                <br />
                <br />
                <b>-----------------------------OR-----------------------------</b>
                <br /><br />
                <label for="csv_file">Upload: </label>
                <input type="file" name="csv_file" id="csv_file" /> <br />
                <br />
                <b>-----------------------------OR-----------------------------</b>
                <br /><br />
                <input type="checkbox" name="all" id="all" value="True" /> Send To All
                <br />
                <br />
                <input type="submit" value="Send" class="myBtn" onclick="spinLoader();" />
            </form>
        </div>
    </div>

    <!-- The Modal for offerletter utility -->
    <div id="offerletterModal" class="modal">
        <!-- Modal content comment -->
        <div class="modal-content">
            <span class="close" onclick="offerletterModal.style.display = 'none'">&times;</span>
            <form method="POST" action="generateOfferLetter/">
                {% csrf_token %}
                <input type="hidden" name="offerletter_utility" value="True" />
                <label for="cname">Company Name: </label> <br />
                <input type="text" name="cname" id="cname" />
                <br />
                <br />
                <label for="hrName">HR Name: </label> <br />
                <input type="text" name="hrName" id="hrName" />
                <br />
                <br />
                <hr />
                <label for="name">Name: </label> <br />
                <input type="text" name="name" id="name" />
                <br />
                <br />
                <label for="domain">Domain: </label> <br />
                <input type="text" name="domain" id="domain" />
                <br /><br />
                <label for="email">Email: </label> <br />
                <input type="email" name="email" id="email" />
                <br /><br />
                <b>-----------------------------OR-----------------------------</b>
                <br /><br />
                <input type="checkbox" name="all" id="all" value="True" /> Send To All
                <br />
                <br />
                <input type="submit" value="Send" class="myBtn" onclick="spinLoader();" />
            </form>
        </div>
    </div>

    <!-- The Modal for certificate utility -->
    <div id="certificateModal" class="modal">
        <!-- Modal content comment -->
        <div class="modal-content">
            <span class="close" onclick="certificateModal.style.display = 'none'">&times;</span>
            <form method="POST" action="generateCertificate/">
                {% csrf_token %}
                <input type="hidden" name="certificate_utility" value="True" />
                <label for="name">Name: </label> <br />
                <input type="text" name="name" id="name" />
                <br />
                <br />
                <label for="domain">Domain: </label> <br />
                <input type="text" name="domain" id="domain" />
                <br /><br />
                <label for="email">Email: </label> <br />
                <input type="email" name="email" id="email" />
                <br /><br />
                <b>-----------------------------OR-----------------------------</b>
                <br /><br />
                <input type="checkbox" name="all" id="all" value="True" /> Send To All
                <br />
                <br />
                <input type="submit" value="Send" class="myBtn" onclick="spinLoader();" />
            </form>
        </div>
    </div>
    <!--!--------------------------------------------------------  -->

    <!--! Form Cards---------------------------------------------- -->
    <div class="cards-container">
        {% for form in forms %}
        <div class="card">
            <div class="card-data" id="card-details-{{form.fid}}">
                <h3 class="my-30">Internship Details : {{form.date}}</h3>
                <div class="card-data-grp mt-40">
                    <p class="px-5">URL: </p>
                    <input type="text" value="{{form.url}}" id="{{form.fid}}" class="px-5" />
                    <div class="tooltip" class="px-5">
                        <a onclick="copyText('{{form.fid}}');" onmouseout="outFunc();">
                            <span class="tooltiptext" id="myTooltip">Copy to clipboard</span>
                            <i class="fa fa-clone" style="font-size: 24px; margin-left: 5px"></i>
                        </a>
                    </div>
                </div>
                <div class="card-data-grp mt-40">
                    <p class="px-5 mr-10">
                        Form Status: {% if form.form_status == True %}
                        <b>Open</b>
                        {% else %}
                        <b>Close</b>
                        {% endif %}
                    </p>
                    <label class="switch mx-5">
                        {% if form.form_status == True %}
                        <input type="checkbox" name="url_status_cb" id="url_status_cb" checked
                            onchange="toogleUrlStatus('{{form.fid}}');" />
                        {% else %}
                        <input type="checkbox" name="url_status_cb" id="url_status_cb"
                            onchange="toogleUrlStatus('{{form.fid}}');" />
                        {% endif %}
                        <span class="slider round"></span>
                    </label>
                </div>
                <div class="menu-btn" onclick="toogle('{{form.fid}}');">
                    <i class="fa fa-bars" aria-hidden="true"></i>
                </div>
            </div>
            <div class="card-utils" id="card-utils-{{form.fid}}">
                <a href="{% url 'toTdetails' form.fid %}" class="a-btn-white">
                    <div class="circle-btn cb1">
                        <i class="fa fa-info" aria-hidden="true"></i>

                    </div>
                </a>

                <div class="circle-btn cb2" onclick="emailModal.style.display='block';session('{{ form.fid }}');">
                    <i class="fa fa-envelope-o" aria-hidden="true"></i>
                </div>

                <div class="circle-btn cb3" onclick="offerletterModal.style.display='block';session('{{ form.fid }}');">
                    <i class="fa fa-file-text-o" aria-hidden="true"></i>
                </div>

                <div class="circle-btn cb4" onclick="certificateModal.style.display='block';session('{{ form.fid }}');">
                    <i class="fa fa-address-card-o" aria-hidden="true"></i>
                </div>

                <a href="{% url 'delForm' form.fid %}" class="a-btn-white">
                    <div class="circle-btn cb5">
                        <i class="fa fa-trash-o" aria-hidden="true"></i>
                    </div>
                </a>

                <div class="circle-btn cb6" onclick="toogle('{{form.fid}}');">
                    <i class="fa fa-times" aria-hidden="true"></i>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    <!--!----------------------------------------------------------- -->
</body>

<script type="text/javascript">
    // Get the modal
    var newFormModal = document.getElementById( "newFormModal" );
    var emailModal = document.getElementById( "emailModal" );
    var offerletterModal = document.getElementById( "offerletterModal" );
    var certificateModal = document.getElementById( "certificateModal" );
    var alertModal = document.getElementById( "alertModal" );

    // Function for changing internship details card content.
    function toogle( fid )
    {
        let card_utils = document.getElementById( 'card-utils-' + fid )
        let card_details = document.getElementById( 'card-details-' + fid );
        if ( window.getComputedStyle( card_utils ).display == "none" )
        {
            card_details.style.display = "none";
            card_utils.style.display = "block";
        } else
        {
            card_utils.style.display = "none";
            card_details.style.display = "block";
        }
    }

    function spinLoader()
    {
        var spinModal = document.getElementById( "spinModal" );
        spinModal.style.display = "block";
        emailModal.style.display = "none";
        offerletterModal.style.display = "none";
        certificateModal.style.display = "none";
    }

    function session( fid )
    {
        $.get( "setSession/" + fid + "/", function ( data ) { } );
    }

    function toogleUrlStatus( fid )
    {
        $.get( "toogleUrlStatus/" + fid + "/", function ( data )
        {
            location.reload();
        } );
    }

    function copyText( inpId )
    {
        var copyText = document.getElementById( inpId );
        copyText.select();
        copyText.setSelectionRange( 0, 99999 );
        navigator.clipboard.writeText( copyText.value );

        var tooltip = document.getElementById( "myTooltip" );
        tooltip.innerHTML = "Copied";
    }

    function outFunc()
    {
        var tooltip = document.getElementById( "myTooltip" );
        tooltip.innerHTML = "Copy to clipboard";
    }
</script>

</html>